<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ruang Dokter</title>

  <!-- favicon (pastikan assets/favicon.png ada) -->
  <link rel="icon" href="assets/favicon.png" type="image/png">

  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <img id="logo" src="assets/logo_header.png" alt="Ruang Dokter" height="36">
      <div class="brand-text">
        <div class="app-title">Ruang Dokter</div>
        <div class="header-sub" id="headerNamaDokter"></div>
      </div>
    </div>

    <div class="top-actions">
      <button id="themeToggle" class="icon-btn" title="Ganti mode">ðŸŒ“</button>
      <button id="editProfileBtn" class="btn small" title="Ubah profil">Ubah Profil</button>
      <button id="feedbackBtn" class="btn small">Saran & Masukan</button>
    </div>
  </header>

  <main class="container">
    <nav class="tabs">
      <button class="tabbtn active" data-tab="konsul">Konsul</button>
      <button class="tabbtn" data-tab="kalkulator">Kalkulator</button>
      <button class="tabbtn" data-tab="history">History</button>
      <button class="tabbtn" data-tab="template">Template</button>
      <button class="tabbtn" data-tab="setting">Pengaturan</button>
    </nav>

    <!-- KONSUL -->
    <section id="konsul" class="tab" style="display:block">
      <div class="card">
        <h3>Identitas & Profil</h3>
        <div class="form-row">
          <input id="nama" placeholder="Nama pasien" />
          <input id="usia" placeholder="Usia (tahun)" />
          <select id="jk">
            <option value="">JK</option>
            <option value="M">L</option>
            <option value="F">P</option>
          </select>
          <div id="bbRow" class="hidden-row"><input id="bb" placeholder="BB (kg)" /></div>
        </div>

        <div class="form-row">
          <input id="nama_dokter" placeholder="Nama dokter (dari profil)" />
          <input id="rs" placeholder="Nama Rumah Sakit (dari profil)" />
          <input id="unit" placeholder="Unit / Bagian (dari profil)" />
        </div>
      </div>

      <div class="card">
        <h3>Subjective</h3>
        <textarea id="s" rows="3" placeholder="Keluhan / riwayat singkat..."></textarea>
      </div>

      <div class="card">
        <h3>Objective</h3>

        <div class="subcard">
          <div class="gcs-ttv">
            <div class="gcs">
              <label>GCS</label>
              <input id="gcsE" placeholder="E" maxlength="1" />
              <input id="gcsV" placeholder="V" maxlength="1" />
              <input id="gcsM" placeholder="M" maxlength="1" />
            </div>

            <div class="ttv">
              <label>TTV</label>
              <input id="td" placeholder="TD (s/d), mis: 120/80" />
              <input id="hr" placeholder="HR" />
              <input id="rr" placeholder="RR" />
              <input id="temp" placeholder="T (Â°C)" />
              <div class="spo2-row">
                <input id="spo2" placeholder="SpO2 (%)" />
                <select id="o2type">
                  <option value="RA">room air</option>
                  <option value="NC">O2 NC</option>
                  <option value="NRM">O2 NRM</option>
                  <option value="VENT">O2 Ventilator</option>
                </select>
                <input id="o2flow" placeholder="LPM (jika ada)" class="o2flow" />
              </div>
            </div>
          </div>

          <div id="map_qsofa" class="muted small"></div>
          <div id="ews_box" class="muted small"></div>
        </div>

        <div class="subcard">
          <label>Pemeriksaan fisik</label>
          <textarea id="kepala" rows="2" placeholder="Kepala (default CA -/-, SI -/-)"></textarea>
          <textarea id="thorax" rows="2" placeholder="Thorax (default ves +/+, ... )"></textarea>
          <textarea id="abdomen" rows="2" placeholder="Abdomen (default supel, BU +)"></textarea>
          <textarea id="ekstremitas" rows="2" placeholder="Ekstremitas (default akral hangat, CRT <2s)"></textarea>
          <textarea id="pemeriksaan_lain" rows="2" placeholder="Pemeriksaan tambahan (opsional)"></textarea>
        </div>
      </div>

      <div class="card">
        <h3>Assessment & Plan</h3>
        <textarea id="dx" rows="2" placeholder="Diagnosa (boleh multi-line, tekan Enter)"></textarea>
        <textarea id="p" rows="3" placeholder="P (terapi / plan)"></textarea>

        <div class="form-actions">
          <button id="buatBtn" class="btn">Buat & Tampilkan</button>
          <button id="copyBtn" class="btn">Copy</button>
          <button id="copyNoIdBtn" class="btn">Copy (tanpa identitas)</button>
          <button id="saveBtn" class="btn">Simpan ke History</button>
          <button id="resetBtn" class="btn secondary">Reset</button>
        </div>

        <h4>Hasil Konsul</h4>
        <pre id="hasil" readonly></pre>
      </div>
    </section>

    <!-- KALKULATOR -->
    <section id="kalkulator" class="tab">
      <div class="card">
        <h3>Kalkulator Klinis</h3>
        <div class="calc-grid">
          <div>
            <h4>BMI</h4>
            <input id="calc_bb" placeholder="BB (kg)" />
            <input id="calc_tb" placeholder="TB (cm)" />
            <button id="calc_bmi" class="btn small">Hitung BMI</button>
            <div id="bmi_res" class="muted"></div>
          </div>
          <div>
            <h4>MAP</h4>
            <input id="map_sys" placeholder="Systolic" />
            <input id="map_dia" placeholder="Diastolic" />
            <button id="calc_map" class="btn small">Hitung MAP</button>
            <div id="map_res" class="muted"></div>
          </div>
          <div>
            <h4>EWS</h4>
            <input id="ews_rr" placeholder="RR" />
            <input id="ews_spo2" placeholder="SpO2" />
            <input id="ews_hr" placeholder="HR" />
            <input id="ews_temp" placeholder="T" />
            <input id="ews_gcs" placeholder="GCS total" />
            <button id="calc_ews" class="btn small">Hitung EWS</button>
            <div id="ews_res" class="muted"></div>
          </div>
          <div>
            <h4>BSA</h4>
            <input id="bsa_bb" placeholder="BB" />
            <input id="bsa_tb" placeholder="TB" />
            <button id="calc_bsa" class="btn small">Hitung BSA</button>
            <div id="bsa_res" class="muted"></div>
          </div>
          <div>
            <h4>Anion Gap</h4>
            <input id="ag_na" placeholder="Na" />
            <input id="ag_cl" placeholder="Cl" />
            <input id="ag_hco3" placeholder="HCO3" />
            <button id="calc_ag" class="btn small">Hitung AG</button>
            <div id="ag_res" class="muted"></div>
          </div>
          <div>
            <h4>eGFR (CKD-EPI)</h4>
            <input id="gfr_age" placeholder="Umur" />
            <select id="gfr_sex"><option value="M">L</option><option value="F">P</option></select>
            <input id="gfr_scr" placeholder="Kreatinin (mg/dL)" />
            <button id="calc_gfr" class="btn small">Hitung eGFR</button>
            <div id="gfr_res" class="muted"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- HISTORY -->
    <section id="history" class="tab">
      <div class="card">
        <h3>History Konsul</h3>
        <div class="history-controls">
          <select id="historyFilter">
            <option value="all">Semua</option>
            <option value="done">Selesai</option>
            <option value="undone">Belum Selesai</option>
          </select>
          <input id="historySearch" placeholder="Cari nama / diagnosa..." />
          <button id="exportJson" class="btn small">Export JSON</button>
          <input type="file" id="importFile" style="display:none" />
          <button id="importBtn" class="btn small">Import JSON</button>
        </div>
        <div id="historyList"></div>
      </div>
    </section>

    <!-- TEMPLATE -->
    <section id="template" class="tab">
      <div class="card">
        <h3>Template</h3>
        <div class="template-form">
          <input id="templateTitle" placeholder="Judul (diagnosis)"/>
          <input id="templateDx" placeholder="Diagnosa (singkat)"/>
          <textarea id="templatePhys" rows="2" placeholder="Pemeriksaan kepala default untuk template"></textarea>
          <textarea id="templatePlan" rows="2" placeholder="Terapi/Plan default"></textarea>
          <div class="form-actions">
            <button id="addTemplate" class="btn">Tambah Template</button>
            <button id="clearTemplates" class="btn secondary">Hapus Semua</button>
          </div>
        </div>
        <div id="templateList"></div>
      </div>
    </section>

    <!-- SETTING -->
    <section id="setting" class="tab">
      <div class="card">
        <h3>Pengaturan</h3>
        <div class="muted">Profil, tema, dan data (local)</div>
        <div style="margin-top:12px">
          <button id="resetProfile" class="btn small secondary">Reset Profil</button>
          <button id="clearAllData" class="btn small secondary">Hapus Semua Data (History & Template)</button>
        </div>
        <div style="margin-top:12px">
          <label>Autosave draft: <span id="autosaveIndicator" class="muted">-</span></label>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer" id="footer"></footer>

  <!-- Setup Profile Overlay (will be toggled by script) -->
  <div id="setupOverlay" class="overlay" style="display:none">
    <div class="overlay-card">
      <h3>Sebelum mulai â€” isi profil singkat</h3>
      <input id="setup_nama_dokter" placeholder="Nama Dokter (contoh: Dr. Agung Satria)" />
      <input id="setup_rs" placeholder="Rumah Sakit (contoh: RSAM)" />
      <input id="setup_unit" placeholder="Unit / Bagian (contoh: IGD)" />
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:8px">
        <button id="setupSkipBtn" class="btn secondary">Lewati</button>
        <button id="setupSaveBtn" class="btn">Simpan & Lanjutkan</button>
      </div>
      <div id="setupErr" class="muted error" style="display:none;margin-top:8px">Isi semua field dulu.</div>
    </div>
  </div>

  <!-- Feedback modal -->
  <div id="feedbackModal" class="overlay" style="display:none;align-items:center;justify-content:center">
    <div class="overlay-card">
      <h3>Saran & Masukan</h3>
      <p>Klik tombol untuk membuka WhatsApp.</p>
      <a id="waLink" class="btn" href="#" target="_blank">Kirim lewat WhatsApp</a>
      <button id="fbClose" class="btn secondary">Tutup</button>
    </div>
  </div>

  <script src="script.js"></script>
</body>
</html>
